# #3 Documento de Aprendizaje - Node.js y npm

## ğŸ“‹ Ãndice
1. Â¿QuÃ© es Node.js?
2. Â¿QuÃ© es npm?
3. package.json - El Archivo de ConfiguraciÃ³n
4. Scripts de npm
5. Dependencias vs DevDependencies
6. MÃ³dulos ES6 en Node.js
7. Variables de Entorno (.env)
8. Comandos npm Esenciales
9. Ejemplos de la AplicaciÃ³n

---

## 1. Â¿QuÃ© es Node.js?

**Node.js** es un **entorno de ejecuciÃ³n** que permite ejecutar JavaScript **fuera del navegador**, en el servidor.

### Antes de Node.js

```
JavaScript SOLO funcionaba en navegadores:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Navegador   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   JS   â”‚  â”‚  â† JavaScript aquÃ­
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Con Node.js

```
JavaScript ahora funciona TAMBIÃ‰N en servidores:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Navegador   â”‚        â”‚   Servidor   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   JS   â”‚  â”‚  â†â”€â”€â”€â”€â†’  â”‚ Node.jsâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Â¿Para quÃ© sirve?

- **Crear servidores web** (como nuestro backend)
- **Crear APIs REST**
- **Acceder al sistema de archivos**
- **Conectar a bases de datos**
- **Herramientas de lÃ­nea de comandos**

### VersiÃ³n de Node.js

```bash
# Ver versiÃ³n instalada
node --version
# o
node -v

# Resultado: v18.17.0 (o similar)
```

---

## 2. Â¿QuÃ© es npm?

**npm** (Node Package Manager) es el **gestor de paquetes** de Node.js.

### AnalogÃ­a

```
npm es como una "tienda de aplicaciones" para programadores:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         npm Registry            â”‚
â”‚  (npmjs.com - Millones de       â”‚
â”‚   paquetes disponibles)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“ instalar
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Tu Proyecto                â”‚
â”‚  node_modules/                  â”‚
â”‚    â”œâ”€ express/                  â”‚
â”‚    â”œâ”€ react/                    â”‚
â”‚    â”œâ”€ bcryptjs/                 â”‚
â”‚    â””â”€ ...                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Paquetes vs MÃ³dulos

- **Paquete:** CÃ³digo de terceros que instalas (ej: `express`, `react`)
- **MÃ³dulo:** Cualquier archivo `.js` que puedes importar

```javascript
// Importar paquete de terceros
import express from 'express';

// Importar mÃ³dulo propio
import { login } from './controllers/auth.js';
```

---

## 3. package.json - El Archivo de ConfiguraciÃ³n

### Â¿QuÃ© es package.json?

Es el **archivo de configuraciÃ³n** de tu proyecto Node.js. Define:

- Nombre y versiÃ³n del proyecto
- Scripts para ejecutar tareas
- Dependencias (paquetes necesarios)
- Configuraciones del proyecto

### Estructura de package.json de la App

```json
{
  "name": "pagina-solpeds",
  "private": true,
  "version": "1.0.0",
  "type": "module",
  "scripts": { ... },
  "dependencies": { ... },
  "devDependencies": { ... }
}
```

### Campos Importantes

#### 1. `name` - Nombre del Proyecto

```json
"name": "pagina-solpeds"
```

- Debe ser **minÃºsculas** y sin espacios
- Usa guiones `-` en lugar de espacios

#### 2. `version` - VersiÃ³n del Proyecto

```json
"version": "1.0.0"
```

- Formato: **MAJOR.MINOR.PATCH**
  - `1.0.0` â†’ `1.0.1` (correcciÃ³n de bug)
  - `1.0.1` â†’ `1.1.0` (nueva funcionalidad)
  - `1.1.0` â†’ `2.0.0` (cambio incompatible)

#### 3. `type` - Tipo de MÃ³dulos

```json
"type": "module"
```

**MUY IMPORTANTE:**

- `"type": "module"` â†’ Permite usar `import/export` (ES6)
- Sin esto â†’ Solo puedes usar `require()` (CommonJS - antiguo)

```javascript
// âœ… Con "type": "module"
import express from 'express';
export const login = () => {};

// âŒ Sin "type": "module"
const express = require('express');
module.exports = { login };
```

#### 4. `private` - Proyecto Privado

```json
"private": true
```

- Evita publicar accidentalmente el proyecto en npm
- Siempre usar `true` para proyectos internos

---

## 4. Scripts de npm

### Â¿QuÃ© son los Scripts?

**Scripts** son **comandos personalizados** que puedes ejecutar con `npm run <script>`.

### Scripts de la AplicaciÃ³n (RaÃ­z)

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "backend:install": "cd backend && npm install",
    "backend:init": "cd backend && npm run init-db",
    "backend:dev": "cd backend && npm run dev",
    "backend:start": "cd backend && npm start",
    "start": "concurrently \"npm run backend:start\" \"npm run dev\" --names \"backend,frontend\" --prefix-colors \"blue,green\"",
    "start:all": "npm run start",
    "install:all": "npm install && npm run backend:install",
    "setup": "npm run install:all && npm run backend:init",
    "deploy:build": "npm install && npm run build && cd backend && npm install"
  }
}
```

### CÃ³mo Ejecutar Scripts

```bash
# Ejecutar script especÃ­fico
npm run dev             # Frontend en desarrollo
npm run build           # Compilar frontend
npm run backend:dev     # Backend en desarrollo
npm run start           # Frontend + Backend juntos

# Atajo especial: "start" puede ejecutarse sin "run"
npm start               # Equivalente a: npm run start
```

### AnÃ¡lisis de Scripts Importantes

#### 1. `dev` - Desarrollo Frontend

```json
"dev": "vite"
```

**QuÃ© hace:**
- Ejecuta el comando `vite`
- Inicia servidor de desarrollo en `http://localhost:5173`
- Hot reload (recarga automÃ¡tica al cambiar cÃ³digo)

**CuÃ¡ndo usar:**
```bash
npm run dev
```

#### 2. `build` - Compilar Frontend

```json
"build": "vite build"
```

**QuÃ© hace:**
- Compila el cÃ³digo React para producciÃ³n
- Crea carpeta `/dist` con archivos optimizados
- Minifica y optimiza el cÃ³digo

**CuÃ¡ndo usar:**
```bash
npm run build
```

#### 3. `backend:dev` - Desarrollo Backend

```json
"backend:dev": "cd backend && npm run dev"
```

**QuÃ© hace:**
1. `cd backend` â†’ Entra a carpeta backend
2. `npm run dev` â†’ Ejecuta el script "dev" del backend

**Equivale a:**
```bash
cd backend
npm run dev
```

#### 4. `start` - Todo Junto

```json
"start": "concurrently \"npm run backend:start\" \"npm run dev\" --names \"backend,frontend\" --prefix-colors \"blue,green\""
```

**QuÃ© hace:**
- Usa el paquete `concurrently` para ejecutar **2 comandos simultÃ¡neamente**
- `npm run backend:start` â†’ Inicia backend
- `npm run dev` â†’ Inicia frontend
- `--names` â†’ Etiquetas para identificar cada proceso
- `--prefix-colors` â†’ Colores para diferenciar logs

**Resultado en consola:**
```
[backend] ğŸš€ Servidor Backend iniciado
[backend] ğŸ“¡ http://localhost:3001
[frontend] âœ  Local:   http://localhost:5173/
```

#### 5. `setup` - ConfiguraciÃ³n Inicial

```json
"setup": "npm run install:all && npm run backend:init"
```

**QuÃ© hace:**
1. `npm run install:all` â†’ Instala dependencias de frontend Y backend
2. `&&` â†’ Espera a que termine el anterior
3. `npm run backend:init` â†’ Inicializa la base de datos

**CuÃ¡ndo usar:**
```bash
# Primera vez que clonas el proyecto
npm run setup
```

### Operadores en Scripts

```bash
# && â†’ Ejecutar secuencialmente (si uno falla, se detiene)
"script1 && script2"     # Primero script1, luego script2

# ; â†’ Ejecutar secuencialmente (continÃºa aunque falle)
"script1; script2"       # Primero script1, luego script2 (siempre)

# & â†’ Ejecutar en paralelo (Windows tiene problemas)
"script1 & script2"      # Ambos al mismo tiempo

# Usar concurrently para paralelo multiplataforma
"concurrently \"script1\" \"script2\""
```

---

## 5. Dependencias vs DevDependencies

### dependencies - ProducciÃ³n

**Paquetes NECESARIOS para que la aplicaciÃ³n funcione.**

```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0"
  }
}
```

**CuÃ¡ndo se usan:**
- En producciÃ³n (servidor real)
- Frontend necesita React para funcionar

**Instalar:**
```bash
npm install react
# o
npm i react
```

### devDependencies - Desarrollo

**Paquetes SOLO para desarrollo, NO en producciÃ³n.**

```json
{
  "devDependencies": {
    "@vitejs/plugin-react": "^4.2.1",
    "concurrently": "^8.2.2",
    "vite": "^5.0.8"
  }
}
```

**CuÃ¡ndo se usan:**
- Solo en tu computadora de desarrollo
- Herramientas para compilar, testear, etc.
- NO se suben al servidor de producciÃ³n

**Instalar:**
```bash
npm install --save-dev vite
# o
npm i -D vite
```

### Versionado SemÃ¡ntico

```json
{
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "~18.2.0",
    "jwt": "1.0.0"
  }
}
```

**SÃ­mbolos:**

```
^18.2.0  â†’  Compatible con cambios menores
            Permite: 18.2.1, 18.3.0, 18.9.9
            NO permite: 19.0.0

~18.2.0  â†’  Compatible solo con parches
            Permite: 18.2.1, 18.2.9
            NO permite: 18.3.0

1.0.0    â†’  VersiÃ³n exacta (sin sÃ­mbolo)
            Solo permite: 1.0.0
```

---

## 6. MÃ³dulos ES6 en Node.js

### Habilitar ES6 Modules

```json
{
  "type": "module"
}
```

Sin esto, Node.js usa **CommonJS** (sistema antiguo).

### Diferencias

```javascript
// âŒ CommonJS (antiguo - SIN "type": "module")
const express = require('express');
const { login } = require('./controllers/auth');

module.exports = { login };

// âœ… ES6 Modules (moderno - CON "type": "module")
import express from 'express';
import { login } from './controllers/auth.js';

export { login };
```

### Extensiones de Archivo

```javascript
// âš ï¸ Con "type": "module" debes incluir .js

// âŒ Error
import { login } from './controllers/auth';

// âœ… Correcto
import { login } from './controllers/auth.js';
```

### import.meta.url y __dirname

```javascript
// âŒ __dirname NO existe en ES6 modules

// âœ… Alternativa en ES6
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

// Ahora puedes usar __dirname
const dbPath = join(__dirname, 'database.sqlite');
```

**Ejemplo Real:**

```javascript
// backend/server.js

import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

// Servir archivos estÃ¡ticos
app.use('/uploads', express.static(join(__dirname, 'uploads')));
```

---

## 7. Variables de Entorno (.env)

### Â¿QuÃ© son las Variables de Entorno?

**Configuraciones que cambian segÃºn el entorno** (desarrollo, producciÃ³n).

### Archivo .env

```bash
# .env (en la raÃ­z del proyecto)

PORT=3001
JWT_SECRET=mi-secreto-super-seguro-12345
DATABASE_PATH=database.sqlite
NODE_ENV=development
FRONTEND_URL=http://localhost:5173
```

### Â¿Por quÃ© usar .env?

```
âœ… Ventajas:
  - Diferentes configuraciones por entorno
  - NO subir secretos a Git (.gitignore)
  - FÃ¡cil cambiar configuraciÃ³n sin tocar cÃ³digo

âŒ Sin .env (valores fijos en cÃ³digo):
  const JWT_SECRET = 'abc123';  // âŒ Visible en Git
  const PORT = 3001;            // âŒ No se puede cambiar fÃ¡cilmente
```

### Usando dotenv

```javascript
// backend/server.js

import dotenv from 'dotenv';

// Cargar variables de .env
dotenv.config();

// Acceder a variables
const PORT = process.env.PORT || 3001;
const JWT_SECRET = process.env.JWT_SECRET;

console.log(PORT);        // 3001
console.log(JWT_SECRET);  // 'mi-secreto-super-seguro-12345'
```

### .gitignore

```bash
# .gitignore

# IMPORTANTE: NO subir .env a Git
.env

# Subir ejemplo SIN valores reales
.env.example  # âœ… Este SÃ se sube
```

### .env.example

```bash
# .env.example (ejemplo para otros desarrolladores)

PORT=3001
JWT_SECRET=tu-secreto-aqui
DATABASE_PATH=database.sqlite
NODE_ENV=development
FRONTEND_URL=http://localhost:5173
```

**Otro desarrollador hace:**

```bash
# 1. Copiar el ejemplo
cp .env.example .env

# 2. Editar .env con sus propios valores
```

---

## 8. Comandos npm Esenciales

### Instalar Paquetes

```bash
# Instalar todas las dependencias del package.json
npm install
# o
npm i

# Instalar paquete especÃ­fico (producciÃ³n)
npm install express
npm i express

# Instalar paquete de desarrollo
npm install --save-dev vite
npm i -D vite

# Instalar globalmente (disponible en todo el sistema)
npm install -g nodemon
```

### Desinstalar Paquetes

```bash
# Desinstalar y quitar de package.json
npm uninstall express
npm un express
```

### Actualizar Paquetes

```bash
# Ver paquetes desactualizados
npm outdated

# Actualizar todos los paquetes
npm update

# Actualizar paquete especÃ­fico
npm update react
```

### Ejecutar Scripts

```bash
# Ejecutar script de package.json
npm run dev
npm run build
npm run backend:dev

# "start" es especial, no necesita "run"
npm start
```

### Ver InformaciÃ³n

```bash
# Ver versiÃ³n de npm
npm --version
npm -v

# Ver paquetes instalados
npm list

# Ver solo dependencias de primer nivel
npm list --depth=0

# InformaciÃ³n de un paquete
npm info react
```

### CachÃ© de npm

```bash
# Limpiar cachÃ© (Ãºtil si hay errores extraÃ±os)
npm cache clean --force
```

---

## 9. Ejemplos de la AplicaciÃ³n

### package.json del Frontend (RaÃ­z)

```json
{
  "name": "pagina-solpeds",
  "private": true,
  "version": "1.0.0",
  "type": "module",

  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "backend:install": "cd backend && npm install",
    "backend:init": "cd backend && npm run init-db",
    "backend:dev": "cd backend && npm run dev",
    "backend:start": "cd backend && npm start",
    "start": "concurrently \"npm run backend:start\" \"npm run dev\" --names \"backend,frontend\" --prefix-colors \"blue,green\"",
    "install:all": "npm install && npm run backend:install",
    "setup": "npm run install:all && npm run backend:init"
  },

  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0"
  },

  "devDependencies": {
    "@types/react": "^18.2.43",
    "@types/react-dom": "^18.2.17",
    "@vitejs/plugin-react": "^4.2.1",
    "concurrently": "^8.2.2",
    "vite": "^5.0.8"
  }
}
```

### Flujo de InstalaciÃ³n Completa

```bash
# 1. Clonar repositorio
git clone https://github.com/usuario/Pagina-solpeds.git
cd Pagina-solpeds

# 2. Ejecutar setup (instala todo y crea BD)
npm run setup

# Equivale a:
# npm install                  â†’ Instala deps del frontend
# cd backend && npm install    â†’ Instala deps del backend
# cd backend && npm run init-db â†’ Crea base de datos
```

### Flujo de Desarrollo Diario

```bash
# OpciÃ³n 1: Todo junto
npm start
# Inicia frontend (5173) + backend (3001) simultÃ¡neamente

# OpciÃ³n 2: Por separado (2 terminales)
# Terminal 1:
npm run dev           # Frontend

# Terminal 2:
npm run backend:dev   # Backend
```

### Importar MÃ³dulos Node.js Nativos

```javascript
// backend/server.js

// MÃ³dulos nativos de Node.js (no necesitan npm install)
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';
import { readFileSync, writeFileSync, existsSync } from 'fs';

// MÃ³dulos instalados con npm
import express from 'express';
import cors from 'cors';
import dotenv from 'dotenv';

// MÃ³dulos propios
import { initDatabase } from './config/database.js';
import authRoutes from './routes/auth.js';
```

### process.env - Variables de Entorno

```javascript
// backend/server.js

import dotenv from 'dotenv';

// Cargar .env
dotenv.config();

const app = express();

// Usar variables de entorno con valores por defecto
const PORT = process.env.PORT || 3001;
const NODE_ENV = process.env.NODE_ENV || 'development';

console.log(`Servidor en puerto ${PORT}`);
console.log(`Entorno: ${NODE_ENV}`);

// En JWT
const JWT_SECRET = process.env.JWT_SECRET;

app.listen(PORT, () => {
  console.log(`Servidor iniciado en http://localhost:${PORT}`);
});
```

---

## 10. Resumen Visual

### Estructura de un Proyecto Node.js

```
proyecto/
â”‚
â”œâ”€â”€ ğŸ“„ package.json           â† ConfiguraciÃ³n del proyecto
â”œâ”€â”€ ğŸ“„ package-lock.json      â† Versiones exactas (auto-generado)
â”œâ”€â”€ ğŸ“„ .env                   â† Variables de entorno (NO subir a Git)
â”œâ”€â”€ ğŸ“„ .env.example           â† Ejemplo de .env (SÃ subir)
â”œâ”€â”€ ğŸ“„ .gitignore             â† Archivos ignorados por Git
â”‚
â”œâ”€â”€ ğŸ“ node_modules/          â† Paquetes instalados (NO subir a Git)
â”‚   â”œâ”€â”€ express/
â”‚   â”œâ”€â”€ react/
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ ğŸ“ src/                   â† CÃ³digo fuente
â”‚   â”œâ”€â”€ App.jsx
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ ğŸ“ backend/
    â”œâ”€â”€ ğŸ“„ package.json       â† Config del backend
    â”œâ”€â”€ ğŸ“ node_modules/      â† Paquetes del backend
    â”œâ”€â”€ server.js
    â””â”€â”€ ...
```

### Ciclo de Vida de npm

```
1. Crear package.json
   npm init

2. Instalar dependencias
   npm install express

3. Actualizar package.json
   "dependencies": { "express": "^4.18.2" }

4. Crear node_modules/
   node_modules/express/...

5. Ejecutar scripts
   npm run dev
```

---

**ğŸ“Œ ContinÃºa con:** [#4 - Express.js y Arquitectura del Backend](#)
